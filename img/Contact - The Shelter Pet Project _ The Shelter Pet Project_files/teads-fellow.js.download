"use strict";!function(){const t={conversionType:"conversion_type",price:"aepp",currency:"aepc",name:"aepn"},n="js-web",e="js-gtm",o="internal",a="bad_integration",i="TEADS_PIXEL_LOADED",c="TEADS_PIXEL_DEBUG",r="TEADS_PIXEL_EVENT",d="TEADS_SDK_PARAMETERS",s="TEADS_ASK_PIXEL_INFO",l="TEADS_PIXEL_INFO",u="TEADS_CONSENT_INFO_LOADED";function p(t){return"[object Function]"===toString.call(t)}function w(){return!0===window.teads_post_message_event_to_opener}function v(){return!0===window.teads_post_message_event_to_window}function f(t){window.teads_tracking_events_sent||(window.teads_tracking_events_sent=[]),window.teads_tracking_events_sent.push(t)}function _(t){var n;let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:t,id:null===(n=window)||void 0===n?void 0:n.name,ts:Date.now(),...e}}function g(t){var n,e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";if(p(null===(n=window)||void 0===n||null===(e=n.opener)||void 0===e?void 0:e.postMessage))try{window.opener.postMessage(_(t,o),a)}catch(t){}}function m(t){var n;let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";if(p(null===(n=window)||void 0===n?void 0:n.postMessage))try{window.postMessage(_(t,e),o)}catch(t){}}function y(){var t;p(null===(t=window)||void 0===t?void 0:t.addEventListener)&&(g(i),m(i),window.addEventListener("message",t=>{var n,e,o,a,i,r;null!==(n=window)&&void 0!==n&&n.opener&&((null==t||null===(o=t.data)||void 0===o?void 0:o.type)===c&&(r=!0,window.teads_post_message_event_to_opener=r),(null==t||null===(a=t.data)||void 0===a?void 0:a.type)===d&&null!=t&&null!==(i=t.data)&&void 0!==i&&i.teadsClickId&&(F(t.data.teadsClickId),T()));(null==t||null===(e=t.data)||void 0===e?void 0:e.type)===s&&(m(l,{buyerPixelId:Q(),advertiserId:H(),trackingAllowed:G(),firstPartyCookieAllowed:z(),gdprAdvertiser:B(),ccpaAdvertiser:J(),advertiserDomain:W(),auctionId:N(),env:Z(),iabData:X(),uspData:j(),referer:P(k(window)),trackingEventsSent:window.teads_tracking_events_sent||[],request:t.data}),function(t){window.teads_post_message_event_to_window=t}(!0))}))}function h(t,n){let e=0;function o(e,o){o?!1!==e.gdprApplies&&"tcloaded"!==e.eventStatus&&"useractioncomplete"!==e.eventStatus||t(e):n("CMP unable to register callback function. Please check CMP setup.")}function a(){return!(!window.$sf||!window.$sf.ext)}function i(t,n){window.$sf.ext.register(1,1,(function(e,o){if("cmpReturn"===e){const e="getConsentData"===t?o.vendorConsentData:o.vendorConsents;n(e)}})),window.$sf.ext.cmp(t)}function c(t){const n="".concat(2===e?"__tcfapi":"__cmp","Return"),o="string"==typeof t.data&&"".concat(t.data).includes(n)?JSON.parse(t.data):t.data;if(o[n]&&o[n].callId){const t=o[n];void 0!==s[t.callId]&&s[t.callId](t.returnValue,t.success)}}function r(t,n,o){const a=2===e?"__tcfapi":"__cmp",i="".concat(a,"Call");2===e?(window[a]=(t,e,o,a)=>{const c="".concat(Math.random()),r={[i]:{command:t,version:e,parameter:a,callId:c}};s[c]=o,n.postMessage(r,"*")},window.addEventListener("message",c,!1),window[a](t,e,o)):(window[a]=(t,e,o)=>{const a="".concat(Math.random()),c={[i]:{command:t,parameter:e,callId:a}};s[a]=o,n.postMessage(c,"*")},window.addEventListener("message",c,!1),window[a](t,void 0,o))}const d=function(){const n={};function e(){n.getConsentData&&n.getVendorConsents&&t(n)}return{consentDataCallback(t){n.getConsentData=t,e()},vendorConsentsCallback(t){n.getVendorConsents=t,e()}}}(),s={},{cmpFrame:l,cmpFunction:u}=function(){let t,n,o=window;for(;!t;){try{if("function"==typeof o.__tcfapi||"function"==typeof o.__cmp){"function"==typeof o.__tcfapi?(e=2,n=o.__tcfapi):(e=1,n=o.__cmp),t=o;break}}catch(t){}try{if(o.frames.__tcfapiLocator){e=2,t=o;break}}catch(t){}try{if(o.frames.__cmpLocator){e=1,t=o;break}}catch(t){}if(o===window.top)break;o=o.parent}return{cmpFrame:t,cmpFunction:n}}();if(!l)return!1;if(new Promise((t,n)=>{p(u)?u("ping",null,()=>t()):1===e&&a()&&"function"==typeof window.$sf.ext.cmp?i("ping",()=>t()):r("ping",l,()=>t()),setTimeout(()=>n(),100)}).catch(()=>n("Unable to ping the CMP")),p(u)){if(1===e)return u("getConsentData",null,d.consentDataCallback),u("getVendorConsents",null,d.vendorConsentsCallback),!0;if(2===e)return u("addEventListener",e,o),!0}else{if(1===e&&a()&&"function"==typeof window.$sf.ext.cmp)return i("getConsentData",d.consentDataCallback),i("getVendorConsents",d.vendorConsentsCallback),!0;if(1===e)return r("getConsentData",l,d.consentDataCallback),r("getVendorConsents",l,d.vendorConsentsCallback),!0;if(2===e)return r("addEventListener",l,o),!0}return!1}function b(t,n){function e(t,n,e){window.__uspapi=(t,e,o)=>{const i="".concat(Math.random()),c={__uspapiCall:{command:t,version:e,callId:i}};a[i]=o,n.postMessage(c,"*")},window.addEventListener("message",(function(t){const n=t&&t.data&&t.data.__uspapiReturn;n&&n.callId&&void 0!==a[n.callId]&&(a[n.callId](n.returnValue,n.success),delete a[n.callId])}),!1),window.__uspapi(t,1,e)}const o=function(){const e={};return{consentDataCallback:(o,a)=>{a&&o.uspString&&(e.usPrivacy=o.uspString),e.usPrivacy?t(e):n("Unable to get USP consent string.")}}}(),a={},{uspapiFrame:i,uspapiFunction:c}=function(){let t,n,e=window;for(;!t;){try{if("function"==typeof e.__uspapi){n=e.__uspapi,t=e;break}}catch(t){}try{if(e.frames.__uspapiLocator){t=e;break}}catch(t){}if(e===window.top)break;e=e.parent}return{uspapiFrame:t,uspapiFunction:n}}();if(!i)return!1;return new Promise((t,n)=>{p(c)?c("getUSPData",null,()=>t()):e("getUSPData",i,()=>t()),setTimeout(()=>n(),100)}).catch(()=>n("Unable to ping the USP")),p(c)?c("getUSPData",1,o.consentDataCallback):e("getUSPData",i,o.consentDataCallback),!0}function k(t){let n="";const e=function(t){let n=t,e=!1;try{for(let t=0;n.parent.document!==n.document||t<50;t+=1){if(!n.parent.document){e=!0;break}n=n.parent}}catch(t){e=!0}return{topFrame:n,err:e}}(t),{topFrame:o}=e;if(e.err)try{n=o.top.location.href}catch(t){n=o.location.href}else n=o.location.href;return n}function C(t,n,e){try{const o={errorMessage:t,topUrl:k(window),userAgent:void 0!==window.navigator&&void 0!==window.navigator.userAgent?window.navigator.userAgent:"",exception:n||"",version:"5.6.1_28dad1b",type:e||a};t=JSON.stringify(o)}catch(t){}document.createElement("img").src="".concat("https://l.teads.tv/performance/http-source","?").concat(encodeURIComponent(t))}function I(t){const n=document.createElement("img");n.width=0,n.height=0,n.alt="",n.style.position="absolute",n.src=t,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.getElementsByTagName("script")[0].parentNode).insertBefore(n,null),w()&&g(r,{trackingUrl:t}),v()&&m(r,{trackingUrl:t})}function E(t){fetch?fetch(t).then(()=>{w()&&g(r,{trackingUrl:t}),v()&&m(r,{trackingUrl:t})}).catch(()=>{I(t)}):I(t)}function A(t){try{const n=new RegExp(/(?:\?|&|%3F|%26)auctid(?:=|%3D)([0-9a-zA-Z-_]*)/).exec(t);if(n&&n.length>=2)return n[1]}catch(t){C("Error when extracting Auction ID from url",null==t?void 0:t.message,o)}}async function D(t,n,e){var a,i;const c=H(),r=Q(),d=Z(),s=function(t){const n=[];return Object.keys(t).forEach(e=>{n.push("".concat(e,"=").concat(encodeURIComponent(t[e])))}),n.join("&")}(n),l=k(window),u=function(t){let n=N();if(!n){let e=t;t||(e=k(window)),n=A(e),n&&F(n)}return n}(l),p=X(),w=j(),v=B(),f=J(),_=null===(g=document)||void 0===g?void 0:g.title;var g;const m=await async function(){let t=null;try{if(O()){const n=await document.browsingTopics();n&&(t=btoa(JSON.stringify(n)))}}catch(t){C("Error when retrieving topics from Topics API",null==t?void 0:t.message,o)}return t}(),y=P(l);let h="".concat(e,"?action=").concat(t,"&env=").concat(encodeURIComponent(d),"&tag_version=").concat(encodeURIComponent("5.6.1_28dad1b"));return s.length>0&&(h="".concat(h,"&").concat(s)),void 0!==r?h="".concat(h,"&buyer_pixel_id=").concat(encodeURIComponent(r)):void 0!==c&&(h="".concat(h,"&advertiser_id=").concat(encodeURIComponent(c))),h="".concat(h,"&referer=").concat(encodeURIComponent(y)),void 0!==u&&(h="".concat(h,"&auctid=").concat(u)),_&&(h="".concat(h,"&cohort_id=").concat(encodeURIComponent(_))),m&&(h="".concat(h,"&browser_topics=").concat(m)),void 0!==(null==p||null===(a=p.data)||void 0===a?void 0:a.tcString)&&(h="".concat(h,"&gdpr_consent=").concat(p.data.tcString)),null!=v&&v.apply?h="".concat(h,"&gdpr_status=12"):void 0!==(null==v?void 0:v.apply)&&(h="".concat(h,"&gdpr_status=0")),v&&(void 0!==v.apply&&(h="".concat(h,"&gdpr_apply=").concat(v.apply)),void 0!==v.teadsConsent&&(h="".concat(h,"&gtc=").concat(v.teadsConsent)),void 0!==v.isServiceSpecific&&(h="".concat(h,"&gdpr_is_service_specific=").concat(v.isServiceSpecific)),void 0!==v.cmpId&&(h="".concat(h,"&gdpr_cmp_id=").concat(v.cmpId)),void 0!==v.apiVersion&&(h="".concat(h,"&gdpr_api_version=").concat(v.apiVersion))),void 0!==(null==w||null===(i=w.data)||void 0===i?void 0:i.usPrivacy)&&(h="".concat(h,"&ccpa_consent=").concat(w.data.usPrivacy)),f&&(void 0!==f.apply&&(h="".concat(h,"&ca=").concat(f.apply)),void 0!==f.teadsConsent&&(h="".concat(h,"&ctc=").concat(f.teadsConsent))),h}function P(t){const n=["account","password","pass","secret","secretkey","username","user","login","ordernumber","orderid","email","mail","user.email","user.password","user.name","user.mail","user.lastname","user.firstname","user.phone","user.phonenumber","lastname","firstname","name","address","phonenumber","phone","client_secret","guid"];if(""!==t){const e=t.split("?").length>1?t.split("?")[1]:void 0;if(void 0!==e){let o="".concat(t.split("?")[0],"?");const a=e.split("&");for(let t=0;t<a.length;t+=1){const e=a[t].split(/=(.+)/);o="".concat(o+(0===t?"":"&")+e[0],"=").concat(n.indexOf(e[0])>=0?"XXXXXXXX":e[1])}t=o}}return t}async function U(){if(void 0!==window.teads_e){const t=[];for(;window.teads_e.length;)t.push(K(window.teads_e.shift()));await Promise.all(t)}else C("The event queue is not defined.")}function S(t){try{const n="".concat(t,"="),e=document.cookie.split(";");for(let t=0;t<e.length;t+=1)if(e[t]=e[t].trim(),0===e[t].indexOf(n))return e[t].substring(n.length,e[t].length)}catch(n){C('Error while reading first-party cookie with key "'.concat(t,'"'),null==n?void 0:n.message,o)}return""}function R(t,n){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c="".concat(t,"=").concat(n);a&&(c+=";path=".concat(a)),"number"==typeof o&&(c+=";max-age=".concat(o)),e&&(c+=";domain=.".concat(e)),i&&(c+=";samesite=".concat(i)),document.cookie=c}function T(){z()&&N()&&function(t,n,e){try{R(t,n,e,2592e3,"/","strict")}catch(n){C('Error while setting cookie on domain with key "'.concat(t,'"'),null==n?void 0:n.message,o)}}("tfpai",N(),W())}async function x(){var t;const n=H(),e=Q(),a=k(window);let i="referer=".concat(encodeURIComponent(a));void 0!==e?i+="&buyer_pixel_id=".concat(encodeURIComponent(e)):void 0!==n&&(i+="&advertiser_id=".concat(encodeURIComponent(n)));const c=X();var r,d,s,l,u,p;c&&(void 0!==(null==c||null===(r=c.data)||void 0===r?void 0:r.gdprApplies)?i+="&gdpr_applies=".concat(encodeURIComponent(c.data.gdprApplies)):void 0!==(null==c||null===(d=c.data)||void 0===d||null===(s=d.getConsentData)||void 0===s?void 0:s.gdprApplies)&&(i+="&gdpr_applies=".concat(encodeURIComponent(c.data.getConsentData.gdprApplies))),null!=c&&null!==(l=c.data)&&void 0!==l&&l.tcString?i+="&gdpr_consent=".concat(encodeURIComponent(c.data.tcString)):null!=c&&null!==(u=c.data)&&void 0!==u&&null!==(p=u.getConsentData)&&void 0!==p&&p.consentData&&(i+="&gdpr_consent=".concat(encodeURIComponent(c.data.getConsentData.consentData))),null!=c&&c.error&&(i+="&gdpr_error=".concat(encodeURIComponent(c.error))));const w=j();null!=w&&null!==(t=w.data)&&void 0!==t&&t.usPrivacy&&(i+="&ccpa_consent=".concat(encodeURIComponent(w.data.usPrivacy))),null!=w&&w.error&&(i+="&ccpa_error=".concat(encodeURIComponent(w.error)));const v=function(){const t=S("optout");if(t)return"1"===t;return}();void 0!==v&&(i+="&web_opt_out=".concat(encodeURIComponent(v)));try{const t=await fetch("".concat("https://cm.teads.tv","/v2/advertiser?").concat(i));if(200===(null==t?void 0:t.status)){var f,_,g,m,y,h;const n=await t.json();return{trackingAllowed:!1!==(null==n?void 0:n.tracking_allowed),firstPartyCookieAllowed:!0===(null==n?void 0:n.first_party_cookie_allowed),auctionId:null==n?void 0:n.auction_id,domain:null==n?void 0:n.domain,ccpa:null!=n&&n.ccpa?{apply:null===(f=n.ccpa)||void 0===f?void 0:f.apply,teadsConsent:null===(_=n.ccpa)||void 0===_?void 0:_.teads_consent}:void 0,gdpr:null!=n&&n.gdpr?{apply:null===(g=n.gdpr)||void 0===g?void 0:g.apply,teadsConsent:null===(m=n.gdpr)||void 0===m?void 0:m.teads_consent,apiVersion:null===(y=n.gdpr)||void 0===y?void 0:y.api_version,cmpId:null===(h=n.gdpr)||void 0===h?void 0:h.cmp_id,isServiceSpecific:null==n?void 0:n.gdpr.is_service_specific}:void 0}}}catch(t){C("Error while trigger API to know advertiser information",null==t?void 0:t.message,o)}const b=A(a);return b?{trackingAllowed:!0,firstPartyCookieAllowed:!1,auctionId:b}:{trackingAllowed:!0,firstPartyCookieAllowed:!1}}function O(){var t,n,e,o,a;return!(!("browsingTopics"in document)||null===(t=document)||void 0===t||null===(n=t.featurePolicy)||void 0===n||null===(e=n.allowedFeatures)||void 0===e||null===(o=e.call(n))||void 0===o||null===(a=o.includes)||void 0===a||!a.call(o,"browsing-topics"))}async function L(t,n){try{if(null!==(e=document)&&void 0!==e&&null!==(a=e.featurePolicy)&&void 0!==a&&null!==(i=a.allowedFeatures)&&void 0!==i&&null!==(c=i.call(a))&&void 0!==c&&null!==(r=c.includes)&&void 0!==r&&r.call(c,"attribution-reporting")){I(await D(t,n,"".concat("https://cm.teads.tv","/v3/conversion")))}}catch(t){C("Error when triggering attribution reporting conversion",null==t?void 0:t.message,o)}var e,a,i,c,r}function F(t){window.teads_auction_id=t}function N(){return window.teads_auction_id}function M(t){window.teads_iab_consent_data=t}function X(){return window.teads_iab_consent_data}function V(t){window.teads_usp_consent_data=t}function j(){return window.teads_usp_consent_data}function B(){return window.teads_gdpr_advertiser}function J(){return window.teads_ccpa_advertiser}function G(){return!0===window.teads_tracking_allowed}function z(){return!0!==window.teads_disable_first_party_cookie&&window.first_party_cookie_allowed}function W(){return window.advertiser_domain}async function Y(){try{const{auctionId:i,gdpr:c,ccpa:r,firstPartyCookieAllowed:d,domain:s,trackingAllowed:l}=await x();if(a=d,window.first_party_cookie_allowed=a,l&&(e=l,window.teads_tracking_allowed=e),c&&(n=c,window.teads_gdpr_advertiser=n),r&&function(t){window.teads_ccpa_advertiser=t}(r),s&&(t=s,window.advertiser_domain=t),i&&F(i),z()){const t=S("tfpai");!N()&&t&&F(t),T()}else!function(t,n){try{R(t,"",n,0,"/","strict")}catch(n){C('Error while deleting cookie on domain with key "'.concat(t,'"'),null==n?void 0:n.message,o)}}("tfpai",s);v()&&m(u,{trackingAllowed:G(),firstPartyCookieAllowed:z(),gdprAdvertiser:B(),ccpaAdvertiser:J(),advertiserDomain:W(),auctionId:N(),iabData:X(),uspData:j()})}catch(t){C("Error while initializing advertiser",null==t?void 0:t.message,o)}var t,n,e,a}async function $(){const t=H(),n=Q();"number"!=typeof t&&"number"!=typeof n||(await Y(),await async function(){if(!G())return;!function(){if(O()){const t=document.createElement("iframe");t.referrerPolicy="no-referrer-when-downgrade",t.width="0",t.height="0",t.src="https://p.teads.tv/topics.html",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.getElementsByTagName("script")[0].parentNode).insertBefore(t,null)}}();const t=await D("pageView",{},"https://t.teads.tv/track");I(t),f(t),await L("pageView",{});let n=!1;const e=await D("timeSpent",{},"https://t.teads.tv/track");document.addEventListener("visibilitychange",()=>{"hidden"!==document.visibilityState||n||(n=!0,function(t){const n=navigator.sendBeacon&&navigator.sendBeacon.bind(navigator);try{n&&n(t)?(w()&&g(r,{trackingUrl:t}),v()&&m(r,{trackingUrl:t})):E(t)}catch(n){E(t)}}(e),f(e))})}())}async function q(){tt();try{window.teads_adv_id||Object.defineProperty(window,"teads_adv_id",{set(t){this._teads_adv_id=t,$()},get(){return this._teads_adv_id},configurable:!0}),window.teads_buyer_pixel_id||Object.defineProperty(window,"teads_buyer_pixel_id",{set(t){this._teads_buyer_pixel_id=t,$()},get(){return this._teads_buyer_pixel_id},configurable:!0})}catch(t){C("Error while binding advertiser and pixel ids",null==t?void 0:t.message)}await $();const t=window.teads_e||[];window.teads_e=[],window.teads_e.push=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return Array.prototype.push.apply(this,n),U(),window.teads_e.length},window.teads_e.push(...t)}function H(){if(void 0!==window.teads&&void 0!==window.teads.advertiserId){if("number"==typeof window.teads.advertiserId)return window.teads.advertiserId;C("The format of AdvertiserId is not valid.")}else{if(void 0===window.teads_cv||void 0===window.teads_cv.advertiserId)return window.teads_adv_id;if("number"==typeof window.teads_cv.advertiserId)return window.teads_cv.advertiserId;C("The format of AdvertiserId is not valid.")}}function Q(){return window.teads_buyer_pixel_id}function Z(){return window.teads_env&&[n,e].includes(window.teads_env)?window.teads_env:n}async function K(n){if(!G())return;const e=function(n,e){const o={};return Object.keys(n).forEach(a=>{const i=a,c=n[a];Object.prototype.hasOwnProperty.call(t,i)?o[t[i]]=c+(e||""):C("Invalid parameter specified in event: ".concat(i))}),o}(n),o=await D("conversion",e,"https://t.teads.tv/track");I(o),f(o),await L("conversion",e)}function tt(){const t=document.createElement("meta");t.httpEquiv="origin-trial",t.content="A3TnmCYheX1/A4Pqu0Qib4yXjIqWQEcdA9GJee7RDIRUV6VG/zUXn3vw6IG7OlNLrMIdHBLFsS3nd5GHYuSnSwUAAAB+eyJvcmlnaW4iOiJodHRwczovL3RlYWRzLnR2OjQ0MyIsImZlYXR1cmUiOiJQcml2YWN5U2FuZGJveEFkc0FQSXMiLCJleHBpcnkiOjE2NjEyOTkxOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9",document.head.appendChild(t)}function nt(t,n){return new Promise(e=>{t(t=>{n({data:t}),e()},t=>{n({error:t}),e()})||e()})}async function et(t){try{"undefined"!=typeof window&&(y(),await new Promise((n,e)=>{setTimeout(()=>{Promise.all([nt(h,M),nt(b,V)]).then(()=>q()).then(n).catch(e)},t>0?t:0)}))}catch(t){C("Unhandled exception",null==t?void 0:t.message,o)}}et(0),"undefined"!=typeof module&&void 0!==module.exports&&(module.exports.tag=et,module.exports.getTopUrl=k,module.exports.setPrivacySandboxRelevanceAndMeasurementTrialToken=tt)}();